<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yedam.mapper.ReplyMapper">

	<insert id = "insertReply" parameterType = "reply">
		<selectKey keyProperty="replyNo" resultType = "int" order="BEFORE">
			select reply_seq.nextval from dual
		</selectKey>
		
		insert into tbl_reply (reply_no, board_no, reply, replyer)
		values(#{replyNo}, #{boardNo},#{reply},#{replyer})
	</insert>

	
	<select id = "selectReplyList" parameterType = "int" resultType = "reply">
		SELECT ta.*
		  FROM (SELECT /*+ INDEX_DESC(b PK_REPLY)*/ ROWNUM rn
		             , b.*
		          FROM tbl_reply b
                 WHERE board_no = #{boardNo}
		       ) ta
		 WHERE rn > (#{page} - 1) * 5
  		   <![CDATA[
  		   AND rn <= #{page} * 5
  		   ]]>
	</select>
	
	<delete id = "deleteReply" parameterType = "int">
		delete from tbl_reply where reply_no = #{replyNo} 
	</delete>
	
	<select id = "selectCount" parameterType = "int" resultType = "int">
		SELECT count(1)
		  FROM tbl_reply
		 WHERE board_no = #{boardNo}
	</select>
</mapper>
